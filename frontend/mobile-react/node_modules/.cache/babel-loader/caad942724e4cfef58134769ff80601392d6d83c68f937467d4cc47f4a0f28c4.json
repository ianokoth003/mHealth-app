{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import Login from\"./screens/Login\";import Home from\"./screens/Home\";import{uploadSync,listUnsynced}from\"./api/syncService\";import{jsx as _jsx}from\"react/jsx-runtime\";function App(){const[token,setToken]=useState(localStorage.getItem(\"token\"));const[unsyncedCount,setUnsyncedCount]=useState(0);useEffect(()=>{const check=async()=>{const l=await listUnsynced();setUnsyncedCount(l.length);};check();},[]);// auto sync when app gains online\nuseEffect(()=>{const handler=async()=>{if(navigator.onLine){await uploadSync();const l=await listUnsynced();setUnsyncedCount(l.length);}};window.addEventListener(\"online\",handler);return()=>window.removeEventListener(\"online\",handler);},[]);if(!token)return/*#__PURE__*/_jsx(Login,{onLogin:t=>{setToken(t);localStorage.setItem(\"token\",t);}});return/*#__PURE__*/_jsx(Home,{token:token,unsyncedCount:unsyncedCount});}export default App;","map":{"version":3,"names":["React","useEffect","useState","Login","Home","uploadSync","listUnsynced","jsx","_jsx","App","token","setToken","localStorage","getItem","unsyncedCount","setUnsyncedCount","check","l","length","handler","navigator","onLine","window","addEventListener","removeEventListener","onLogin","t","setItem"],"sources":["C:/Users/Administrator/Downloads/mhealth/frontend/mobile-react/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Login from \"./screens/Login\";\r\nimport Home from \"./screens/Home\";\r\nimport { uploadSync, listUnsynced } from \"./api/syncService\";\r\n\r\nfunction App(){\r\n  const [token,setToken] = useState(localStorage.getItem(\"token\"));\r\n  const [unsyncedCount,setUnsyncedCount] = useState(0);\r\n\r\n  useEffect(()=>{\r\n    const check = async ()=>{\r\n      const l = await listUnsynced();\r\n      setUnsyncedCount(l.length);\r\n    }\r\n    check();\r\n  },[]);\r\n\r\n  // auto sync when app gains online\r\n  useEffect(()=>{\r\n    const handler = async ()=> {\r\n      if (navigator.onLine) {\r\n        await uploadSync();\r\n        const l = await listUnsynced();\r\n        setUnsyncedCount(l.length);\r\n      }\r\n    };\r\n    window.addEventListener(\"online\", handler);\r\n    return ()=> window.removeEventListener(\"online\", handler);\r\n  },[]);\r\n\r\n  if (!token) return <Login onLogin={(t)=>{ setToken(t); localStorage.setItem(\"token\", t); }} />;\r\n  return <Home token={token} unsyncedCount={unsyncedCount} />;\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,iBAAiB,CACnC,MAAO,CAAAC,IAAI,KAAM,gBAAgB,CACjC,OAASC,UAAU,CAAEC,YAAY,KAAQ,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE7D,QAAS,CAAAC,GAAGA,CAAA,CAAE,CACZ,KAAM,CAACC,KAAK,CAACC,QAAQ,CAAC,CAAGT,QAAQ,CAACU,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC,CAChE,KAAM,CAACC,aAAa,CAACC,gBAAgB,CAAC,CAAGb,QAAQ,CAAC,CAAC,CAAC,CAEpDD,SAAS,CAAC,IAAI,CACZ,KAAM,CAAAe,KAAK,CAAG,KAAAA,CAAA,GAAU,CACtB,KAAM,CAAAC,CAAC,CAAG,KAAM,CAAAX,YAAY,CAAC,CAAC,CAC9BS,gBAAgB,CAACE,CAAC,CAACC,MAAM,CAAC,CAC5B,CAAC,CACDF,KAAK,CAAC,CAAC,CACT,CAAC,CAAC,EAAE,CAAC,CAEL;AACAf,SAAS,CAAC,IAAI,CACZ,KAAM,CAAAkB,OAAO,CAAG,KAAAA,CAAA,GAAW,CACzB,GAAIC,SAAS,CAACC,MAAM,CAAE,CACpB,KAAM,CAAAhB,UAAU,CAAC,CAAC,CAClB,KAAM,CAAAY,CAAC,CAAG,KAAM,CAAAX,YAAY,CAAC,CAAC,CAC9BS,gBAAgB,CAACE,CAAC,CAACC,MAAM,CAAC,CAC5B,CACF,CAAC,CACDI,MAAM,CAACC,gBAAgB,CAAC,QAAQ,CAAEJ,OAAO,CAAC,CAC1C,MAAO,IAAKG,MAAM,CAACE,mBAAmB,CAAC,QAAQ,CAAEL,OAAO,CAAC,CAC3D,CAAC,CAAC,EAAE,CAAC,CAEL,GAAI,CAACT,KAAK,CAAE,mBAAOF,IAAA,CAACL,KAAK,EAACsB,OAAO,CAAGC,CAAC,EAAG,CAAEf,QAAQ,CAACe,CAAC,CAAC,CAAEd,YAAY,CAACe,OAAO,CAAC,OAAO,CAAED,CAAC,CAAC,CAAE,CAAE,CAAE,CAAC,CAC9F,mBAAOlB,IAAA,CAACJ,IAAI,EAACM,KAAK,CAAEA,KAAM,CAACI,aAAa,CAAEA,aAAc,CAAE,CAAC,CAC7D,CAEA,cAAe,CAAAL,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}