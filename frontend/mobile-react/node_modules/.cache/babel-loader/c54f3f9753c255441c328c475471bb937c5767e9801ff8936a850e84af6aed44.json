{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Administrator\\\\Downloads\\\\mhealth\\\\frontend\\\\mobile-react\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport Login from \"./screens/Login\";\nimport Home from \"./screens/Home\";\nimport { uploadSync, listUnsynced } from \"./api/syncService\";\nimport \"./testApi\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction App() {\n  _s();\n  const [token, setToken] = useState(localStorage.getItem(\"token\"));\n  const [unsyncedCount, setUnsyncedCount] = useState(0);\n  useEffect(() => {\n    const check = async () => {\n      const l = await listUnsynced();\n      setUnsyncedCount(l.length);\n    };\n    check();\n  }, []);\n\n  // auto sync when app gains online\n  useEffect(() => {\n    const handler = async () => {\n      if (navigator.onLine) {\n        await uploadSync();\n        const l = await listUnsynced();\n        setUnsyncedCount(l.length);\n      }\n    };\n    window.addEventListener(\"online\", handler);\n    return () => window.removeEventListener(\"online\", handler);\n  }, []);\n  if (!token) return /*#__PURE__*/_jsxDEV(Login, {\n    onLogin: t => {\n      setToken(t);\n      localStorage.setItem(\"token\", t);\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 32,\n    columnNumber: 22\n  }, this);\n  return /*#__PURE__*/_jsxDEV(Home, {\n    token: token,\n    unsyncedCount: unsyncedCount\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 33,\n    columnNumber: 10\n  }, this);\n}\n_s(App, \"ET4/NbGDCD4jSlv7s2hKv2mrbDg=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","Login","Home","uploadSync","listUnsynced","jsxDEV","_jsxDEV","App","_s","token","setToken","localStorage","getItem","unsyncedCount","setUnsyncedCount","check","l","length","handler","navigator","onLine","window","addEventListener","removeEventListener","onLogin","t","setItem","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Administrator/Downloads/mhealth/frontend/mobile-react/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport Login from \"./screens/Login\";\r\nimport Home from \"./screens/Home\";\r\nimport { uploadSync, listUnsynced } from \"./api/syncService\";\r\nimport \"./testApi\";\r\n\r\nfunction App(){\r\n  const [token,setToken] = useState(localStorage.getItem(\"token\"));\r\n  const [unsyncedCount,setUnsyncedCount] = useState(0);\r\n\r\n  useEffect(()=>{\r\n    const check = async ()=>{\r\n      const l = await listUnsynced();\r\n      setUnsyncedCount(l.length);\r\n    }\r\n    check();\r\n  },[]);\r\n\r\n  // auto sync when app gains online\r\n  useEffect(()=>{\r\n    const handler = async ()=> {\r\n      if (navigator.onLine) {\r\n        await uploadSync();\r\n        const l = await listUnsynced();\r\n        setUnsyncedCount(l.length);\r\n      }\r\n    };\r\n    window.addEventListener(\"online\", handler);\r\n    return ()=> window.removeEventListener(\"online\", handler);\r\n  },[]);\r\n\r\n  if (!token) return <Login onLogin={(t)=>{ setToken(t); localStorage.setItem(\"token\", t); }} />;\r\n  return <Home token={token} unsyncedCount={unsyncedCount} />;\r\n}\r\n\r\nexport default App;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAClD,OAAOC,KAAK,MAAM,iBAAiB;AACnC,OAAOC,IAAI,MAAM,gBAAgB;AACjC,SAASC,UAAU,EAAEC,YAAY,QAAQ,mBAAmB;AAC5D,OAAO,WAAW;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEnB,SAASC,GAAGA,CAAA,EAAE;EAAAC,EAAA;EACZ,MAAM,CAACC,KAAK,EAACC,QAAQ,CAAC,GAAGV,QAAQ,CAACW,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAC;EAChE,MAAM,CAACC,aAAa,EAACC,gBAAgB,CAAC,GAAGd,QAAQ,CAAC,CAAC,CAAC;EAEpDD,SAAS,CAAC,MAAI;IACZ,MAAMgB,KAAK,GAAG,MAAAA,CAAA,KAAU;MACtB,MAAMC,CAAC,GAAG,MAAMZ,YAAY,CAAC,CAAC;MAC9BU,gBAAgB,CAACE,CAAC,CAACC,MAAM,CAAC;IAC5B,CAAC;IACDF,KAAK,CAAC,CAAC;EACT,CAAC,EAAC,EAAE,CAAC;;EAEL;EACAhB,SAAS,CAAC,MAAI;IACZ,MAAMmB,OAAO,GAAG,MAAAA,CAAA,KAAW;MACzB,IAAIC,SAAS,CAACC,MAAM,EAAE;QACpB,MAAMjB,UAAU,CAAC,CAAC;QAClB,MAAMa,CAAC,GAAG,MAAMZ,YAAY,CAAC,CAAC;QAC9BU,gBAAgB,CAACE,CAAC,CAACC,MAAM,CAAC;MAC5B;IACF,CAAC;IACDI,MAAM,CAACC,gBAAgB,CAAC,QAAQ,EAAEJ,OAAO,CAAC;IAC1C,OAAO,MAAKG,MAAM,CAACE,mBAAmB,CAAC,QAAQ,EAAEL,OAAO,CAAC;EAC3D,CAAC,EAAC,EAAE,CAAC;EAEL,IAAI,CAACT,KAAK,EAAE,oBAAOH,OAAA,CAACL,KAAK;IAACuB,OAAO,EAAGC,CAAC,IAAG;MAAEf,QAAQ,CAACe,CAAC,CAAC;MAAEd,YAAY,CAACe,OAAO,CAAC,OAAO,EAAED,CAAC,CAAC;IAAE;EAAE;IAAAE,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;EAC9F,oBAAOxB,OAAA,CAACJ,IAAI;IAACO,KAAK,EAAEA,KAAM;IAACI,aAAa,EAAEA;EAAc;IAAAc,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;AAC7D;AAACtB,EAAA,CA3BQD,GAAG;AAAAwB,EAAA,GAAHxB,GAAG;AA6BZ,eAAeA,GAAG;AAAC,IAAAwB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}